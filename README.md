# Path Finding 2D

–ë—ã—Å—Ç—Ä–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—É—Ç–∏ –≤ 2D –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è —Ç—Ä–∏–∞–Ω–≥—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–≤–º–µ—à –Ω–∞ –æ—Å–Ω–æ–≤–µ [poly-math-2d](https://www.npmjs.com/package/poly-math-2d).

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚úÖ **–ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø—É—Ç–∏** —á–µ—Ä–µ–∑ —Ç—Ä–∏–∞–Ω–≥—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª–∏–≥–æ–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ A*
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –ø–æ–ª–∏–≥–æ–Ω–æ–≤** –≤–∫–ª—é—á–∞—è –ø–æ–ª–∏–≥–æ–Ω—ã —Å –¥—ã—Ä–∞–º–∏
- ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏** —Å –ø–æ–º–æ—â—å—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ string-pulling
- ‚úÖ **TypeScript –ø–æ–¥–¥–µ—Ä–∂–∫–∞** —Å –ø–æ–ª–Ω–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π
- ‚úÖ **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** - —Ç–æ–ª—å–∫–æ poly-math-2d
- ‚úÖ **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
npm install path-finding-2d
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```typescript
import { Point, Polygon, PolygonMap } from 'poly-math-2d';
import { NavMesh2d } from 'path-finding-2d';

// –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç–æ–π –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –ø–æ–ª–∏–≥–æ–Ω
const squarePoints = [
    new Point(0, 0),
    new Point(20, 0),
    new Point(20, 20),
    new Point(0, 20)
];

// –°–æ–∑–¥–∞–µ–º –ø–æ–ª–∏–≥–æ–Ω (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç—Ä–∏–∞–Ω–≥—É–ª–∏—Ä—É–µ—Ç—Å—è)
const polygon = new Polygon(squarePoints);
const polygonMap = new PolygonMap([polygon]);

// –°–æ–∑–¥–∞–µ–º –Ω–∞–≤–º–µ—à
const navMesh = new NavMesh2d(polygonMap);

// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ —Ç–æ—á–∫–∞ –≤–Ω—É—Ç—Ä–∏ –Ω–∞–≤–º–µ—à–∞
const pointA = new Point(5, 5);
console.log(navMesh.isPointInNavMesh(pointA)); // true

// –ù–∞—Ö–æ–¥–∏–º –ø—É—Ç—å –º–µ–∂–¥—É –¥–≤—É–º—è —Ç–æ—á–∫–∞–º–∏
const pointB = new Point(15, 15);
const path = navMesh.findPath(pointA, pointB);
console.log(path); // –ú–∞—Å—Å–∏–≤ —Ç–æ—á–µ–∫ –ø—É—Ç–∏
```

## API

### NavMesh2d

–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–∞–≤–º–µ—à–µ–º.

#### –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

```typescript
constructor(polygonMap: PolygonMap)
```

–°–æ–∑–¥–∞–µ—Ç –Ω–∞–≤–º–µ—à –∏–∑ –∫–∞—Ä—Ç—ã –ø–æ–ª–∏–≥–æ–Ω–æ–≤. PolygonMap –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª–∏–≥–æ–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ —Ç—Ä–∏–∞–Ω–≥—É–ª–∏—Ä–æ–≤–∞–Ω—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π poly-math-2d.

#### –ú–µ—Ç–æ–¥—ã

##### `isPointInNavMesh(point: Point): boolean`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ —Ç–æ—á–∫–∞ –≤–Ω—É—Ç—Ä–∏ –Ω–∞–≤–º–µ—à–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `point` - —Ç–æ—á–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `true` –µ—Å–ª–∏ —Ç–æ—á–∫–∞ –≤–Ω—É—Ç—Ä–∏ –Ω–∞–≤–º–µ—à–∞, –∏–Ω–∞—á–µ `false`

##### `findPath(a: Point, b: Point): Point[]`

–ù–∞—Ö–æ–¥–∏—Ç –ø—É—Ç—å –æ—Ç —Ç–æ—á–∫–∏ A –¥–æ —Ç–æ—á–∫–∏ B.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `a` - –Ω–∞—á–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞
- `b` - –∫–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –ú–∞—Å—Å–∏–≤ —Ç–æ—á–µ–∫, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏—Ö –ø—É—Ç—å. –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –µ—Å–ª–∏ –ø—É—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è:**
- –ï—Å–ª–∏ —Ç–æ—á–∫–∞ A –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–∞–≤–º–µ—à–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
- –ï—Å–ª–∏ —Ç–æ—á–∫–∞ B –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–∞–≤–º–µ—à–µ, –∏—â–µ—Ç—Å—è –ø—É—Ç—å –¥–æ –±–ª–∏–∂–∞–π—à–µ–π —Ç–æ—á–∫–∏ –≤ —Ç–æ–º –∂–µ –ø–æ–ª–∏–≥–æ–Ω–µ, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è A
- –ï—Å–ª–∏ A –∏ B –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—Ä—è–º–æ–π –ø—É—Ç—å
- –ü—É—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ª–∏—à–Ω–∏—Ö —Ç–æ—á–µ–∫

## –ê–ª–≥–æ—Ä–∏—Ç–º

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—É—Ç–∏:

1. **–¢—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏—è:** –ü–æ–ª–∏–≥–æ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç—Ä–∏–∞–Ω–≥—É–ª–∏—Ä—É—é—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π poly-math-2d
2. **–ì—Ä–∞—Ñ —Å–æ—Å–µ–¥—Å—Ç–≤–∞:** –¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏ —Å–≤—è–∑–∞–Ω—ã —á–µ—Ä–µ–∑ –æ–±—â–∏–µ —Ä–µ–±—Ä–∞ (connections –≤ TPolygon)
3. **A* –ø–æ–∏—Å–∫:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º A* –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏ —á–µ—Ä–µ–∑ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏
4. **String Pulling –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º string-pulling –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –∫—Ä–∞—Ç—á–∞–π—à–µ–≥–æ –ø—É—Ç–∏ —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç–∞–ª—å–Ω—ã–µ —Ä—ë–±—Ä–∞ –º–µ–∂–¥—É —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞–º–∏
5. **–ü–æ—Ä—Ç–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â–∏–µ —Ä—ë–±—Ä–∞ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ –∫–∞–∫ "–ø–æ—Ä—Ç–∞–ª—ã" –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
6. **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ä–µ–∑–∞–µ—Ç —É–≥–ª—ã –∏ –Ω–∞—Ö–æ–¥–∏—Ç –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç –≤–Ω—É—Ç—Ä–∏ –Ω–∞–≤–º–µ—à–∞

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏:

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±—ã—Å—Ç—Ä—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π (`getDistanceQuick`, `getDistanceSquared`)
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ —Ü–µ–Ω—Ç—Ä—ã —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤
- –ë–∞—Ä–∏—Ü–µ–Ω—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ —Ç–æ—á–∫–∏ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫—É
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è A* –ø–æ–∏—Å–∫–∞
- **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π String Pulling:** –ù–∞—Ö–æ–¥–∏—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç–∞–ª—å–Ω—ã–µ —Ä—ë–±—Ä–∞
- **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏ –∫–æ–≥–¥–∞ –≤–æ–∑–º–æ–∂–µ–Ω –ø—Ä—è–º–æ–π –ø—É—Ç—å
- **–ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–µ–∫—Ü–∏–∏ –∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ–∏—Å–∫–∞ –ø—É—Ç–∏:

```bash
npm run visual
```

–°–æ–∑–¥–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ SVG —Ñ–∞–π–ª–æ–≤:
- `pathfinding-overview.svg` - –æ–±—â–∏–π –æ–±–∑–æ—Ä –≤—Å–µ—Ö –ø–æ–ª–∏–≥–æ–Ω–æ–≤ —Å —Ç—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏–µ–π
- `pathfinding-successful.svg` - —É—Å–ø–µ—à–Ω—ã–µ –ø—É—Ç–∏ –≤–Ω—É—Ç—Ä–∏ –ø–æ–ª–∏–≥–æ–Ω–æ–≤
- `pathfinding-to-outside.svg` - –ø—É—Ç–∏ –∫ —Ç–æ—á–∫–∞–º –≤–Ω–µ –Ω–∞–≤–º–µ—à–∞
- `pathfinding-holes.svg` - —Ä–∞–±–æ—Ç–∞ —Å –¥—ã—Ä–∫–∞–º–∏ –≤ –ø–æ–ª–∏–≥–æ–Ω–∞—Ö
- `pathfinding-detail-polygon1.svg` - –¥–µ—Ç–∞–ª—å–Ω—ã–π –≤–∏–¥ —Å —Ü–µ–Ω—Ç—Ä–∞–º–∏ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ –∏ —Å–≤—è–∑—è–º–∏

**–õ–µ–≥–µ–Ω–¥–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:**
- üü¶ –ü–æ–ª–∏–≥–æ–Ω—ã (—Ä–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ)
- ‚¨ú –î—ã—Ä–∫–∏ –≤ –ø–æ–ª–∏–≥–æ–Ω–∞—Ö (–ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è)
- üü¢ –ù–∞—á–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –ø—É—Ç–µ–π
- üü† –ö–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ –ø—É—Ç–µ–π
- üî¥ –¢–æ—á–∫–∏ –≤–Ω–µ –Ω–∞–≤–º–µ—à–∞
- üü£ –¢–æ—á–∫–∏ –≤ –¥—ã—Ä–∫–∞—Ö
- ‚û°Ô∏è –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—É—Ç–∏ (–∑–µ–ª–µ–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏)

## –ü—Ä–∏–º–µ—Ä—ã

### –°–ª–æ–∂–Ω—ã–π –ø–æ–ª–∏–≥–æ–Ω (L-–æ–±—Ä–∞–∑–Ω–∞—è —Ñ–æ—Ä–º–∞)

```typescript
// –°–æ–∑–¥–∞–µ–º L-–æ–±—Ä–∞–∑–Ω—ã–π –ø–æ–ª–∏–≥–æ–Ω
const lShapePoints = [
    new Point(0, 0),
    new Point(10, 0),
    new Point(10, 5),
    new Point(5, 5),
    new Point(5, 10),
    new Point(0, 10)
];

const lPolygon = new Polygon(lShapePoints);
const lPolygonMap = new PolygonMap([lPolygon]);
const lNavMesh = new NavMesh2d(lPolygonMap);

// –ü–æ–∏—Å–∫ –ø—É—Ç–∏ –≤–æ–∫—Ä—É–≥ —É–≥–ª–∞
const start = new Point(1, 1);
const end = new Point(1, 9);
const path = lNavMesh.findPath(start, end);
```

### –ü–æ–ª–∏–≥–æ–Ω —Å –¥—ã—Ä–∞–º–∏

```typescript
// –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ–ª–∏–≥–æ–Ω
const outerPoints = [
    new Point(0, 0),
    new Point(20, 0),
    new Point(20, 20),
    new Point(0, 20)
];

// –î—ã—Ä–∞ –≤–Ω—É—Ç—Ä–∏ –ø–æ–ª–∏–≥–æ–Ω–∞
const holePoints = [
    new Point(8, 8),
    new Point(12, 8),
    new Point(12, 12),
    new Point(8, 12)
];

const hole = new Polygon(holePoints);
const polygonWithHole = new Polygon(outerPoints, [hole]);
const polygonMap = new PolygonMap([polygonWithHole]);
const navMesh = new NavMesh2d(polygonMap);
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js >= 14
- TypeScript >= 4.0 (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- poly-math-2d >= 0.2.0

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- [poly-math-2d](https://www.npmjs.com/package/poly-math-2d) - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å 2D –ø–æ–ª–∏–≥–æ–Ω–∞–º–∏, —Ç—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏–∏ –∏ –±—É–ª–µ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π 